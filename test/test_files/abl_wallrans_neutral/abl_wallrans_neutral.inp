# Geometry 
geometry.prob_lo                            = 0.0 0.0 0.0
geometry.prob_hi                            = 4096 4096  1024
geometry.is_periodic                        = 1 1 0
# Grid 
amr.n_cell                                  = 64 64 128
amr.max_level                               = 0
# Simulation control parameters
time.stop_time                              = 10
time.max_step                               = -1
time.initial_dt                             = 0.5
time.cfl                                    = 0.5
time.fixed_dt                               = -1
time.init_shrink                            = 0.1
time.regrid_interval                        = -1
time.plot_interval                          = 86400
time.checkpoint_interval                    = 86400
#io
#io.restart_file                             = "chk72000"
io.output_default_variables                  = false
io.outputs                                   = velocity temperature tke mu_turb
# incflo
incflo.physics                              = ABL
incflo.density                              = 1.225
incflo.gravity                              = 0.  0. -9.81  # Gravitational force (3D)
incflo.velocity                             = 10.0 0.0 0.0 
incflo.verbose                              = 0
incflo.initial_iterations                   = 8
incflo.do_initial_proj                      = true
incflo.constant_density                     = true
incflo.use_godunov                          = true
incflo.godunov_type                         = "weno_z"
incflo.diffusion_type                       = 2
# transport equation parameters
transport.model                             = ConstTransport
transport.viscosity                         = 0.0
transport.laminar_prandtl                   = 0.7
transport.turbulent_prandtl                 = 0.333
# turbulence equation parameters
turbulence.model                            = OneEqRANS
TKE.source_terms = Krans
# Atmospheric boundary layer
ABL.Uperiods                                = 12.0
ABL.Vperiods                                = 12.0
ABL.cutoff_height                           = 50.0
ABL.deltaU                                  = 0
ABL.deltaV                                  = 0
ABL.kappa                                   = .41
ABL.normal_direction                        = 2
ABL.perturb_ref_height                      = 50.0
ABL.perturb_velocity                        = true
ABL.perturb_temperature                     = false
ABL.reference_temperature                   = 300.
ABL.stats_output_format                     = netcdf
ABL.surface_roughness_z0                    = 0.1
#ABL.temperature_heights                     = 0  800  900 1800 2700
#ABL.temperature_values                      = 300 300 308 311 314
ABL.wall_shear_stress_type                  = local
ABL.surface_temp_flux                       = 0.0
# Source 
ICNS.source_terms                           = BoussinesqBuoyancy CoriolisForcing GeostrophicForcing RayleighDamping 
BoussinesqBuoyancy.reference_temperature    = 300.0
BoussinesqBuoyancy.thermal_expansion_coeff  = 0.003333
#CoriolisForcing.east_vector                 = 1.0 0.0 0.0
#CoriolisForcing.latitude                    = 45.0
#CoriolisForcing.north_vector                = 0.0 1.0 0.0
#CoriolisForcing.rotational_time_period      = 86400.0
CoriolisForcing.east_vector = 1.0 0.0 0.0
CoriolisForcing.north_vector = 0.0 1.0 0.0
CoriolisForcing.latitude = 90.0
CoriolisForcing.rotational_time_period = 125663.706143592
GeostrophicForcing.geostrophic_wind         = 10 0.0 0.0
RayleighDamping.reference_velocity          = 10 0.0 0.0 
RayleighDamping.length_sloped_damping       = 150
RayleighDamping.length_complete_damping     = 50
RayleighDamping.time_scale                  = 20.0
# BC 
zhi.type                                    = "slip_wall"
zhi.temperature_type                        = "fixed_gradient"
zhi.temperature                             =  0.0
zhi.tke_type                                = "fixed_gradient"
zlo.type                                    = "wall_model"
# MLMG
mac_proj.num_pre_smooth 			 = 32
mac_proj.num_post_smooth 			 = 32
mac_proj.mg_rtol 			 = 1.0e-4
mac_proj.mg_atol 			 = 1.0e-6
mac_proj.maxiter 			 = 360
diffusion.mg_rtol                        = 1e-4
diffusion.mg_atol                        = 1e-6
temperature_diffusion.mg_atol            = 1e-6
temperature_diffusion.mg_rtol            = 1e-4
tke_diffusion.mg_rtol            = 1e-6
tke_diffusion.mg_atol            = 1e-6
nodal_proj.num_pre_smooth 			 = 32
nodal_proj.num_post_smooth 			 = 32
nodal_proj.mg_rtol 			 = 1.0e-4
nodal_proj.mg_atol 			 = 1.0e-6
nodal_proj.maxiter 			 = 360


ABL.initial_wind_profile      = true

ABL.temperature_heights = 0  4.01569  8.03137  12.0471  16.0627  20.0784  24.0941  28.1098  32.1255  36.1412  40.1569  44.1725  48.1882  52.2039  56.2196  60.2353  64.251  68.2667  72.2824  76.298  80.3137  84.3294  88.3451  92.3608  96.3765  100.392  104.408  108.424  112.439  116.455  120.471  124.486  128.502  132.518  136.533  140.549  144.565  148.58  152.596  156.612  160.627  164.643  168.659  172.675  176.69  180.706  184.722  188.737  192.753  196.769  200.784  204.8  208.816  212.831  216.847  220.863  224.878  228.894  232.91  236.925  240.941  244.957  248.973  252.988  257.004  261.02  265.035  269.051  273.067  277.082  281.098  285.114  289.129  293.145  297.161  301.176  305.192  309.208  313.224  317.239  321.255  325.271  329.286  333.302  337.318  341.333  345.349  349.365  353.38  357.396  361.412  365.427  369.443  373.459  377.475  381.49  385.506  389.522  393.537  397.553  401.569  405.584  409.6  413.616  417.631  421.647  425.663  429.678  433.694  437.71  441.725  445.741  449.757  453.773  457.788  461.804  465.82  469.835  473.851  477.867  481.882  485.898  489.914  493.929  497.945  501.961  505.976  509.992  514.008  518.024  522.039  526.055  530.071  534.086  538.102  542.118  546.133  550.149  554.165  558.18  562.196  566.212  570.227  574.243  578.259  582.275  586.29  590.306  594.322  598.337  602.353  606.369  610.384  614.4  618.416  622.431  626.447  630.463  634.478  638.494  642.51  646.525  650.541  654.557  658.573  662.588  666.604  670.62  674.635  678.651  682.667  686.682  690.698  694.714  698.729  702.745  706.761  710.776  714.792  718.808  722.824  726.839  730.855  734.871  738.886  742.902  746.918  750.933  754.949  758.965  762.98  766.996  771.012  775.027  779.043  783.059  787.075  791.09  795.106  799.122  803.137  807.153  811.169  815.184  819.2  823.216  827.231  831.247  835.263  839.278  843.294  847.31  851.325  855.341  859.357  863.373  867.388  871.404  875.42  879.435  883.451  887.467  891.482  895.498  899.514  903.529  907.545  911.561  915.576  919.592  923.608  927.624  931.639  935.655  939.671  943.686  947.702  951.718  955.733  959.749  963.765  967.78  971.796  975.812  979.827  983.843  987.859  991.875  995.89  999.906  1003.92  1007.94  1011.95  1015.97  1019.98  1024  3048 
ABL.wind_heights = 0  4.01569  8.03137  12.0471  16.0627  20.0784  24.0941  28.1098  32.1255  36.1412  40.1569  44.1725  48.1882  52.2039  56.2196  60.2353  64.251  68.2667  72.2824  76.298  80.3137  84.3294  88.3451  92.3608  96.3765  100.392  104.408  108.424  112.439  116.455  120.471  124.486  128.502  132.518  136.533  140.549  144.565  148.58  152.596  156.612  160.627  164.643  168.659  172.675  176.69  180.706  184.722  188.737  192.753  196.769  200.784  204.8  208.816  212.831  216.847  220.863  224.878  228.894  232.91  236.925  240.941  244.957  248.973  252.988  257.004  261.02  265.035  269.051  273.067  277.082  281.098  285.114  289.129  293.145  297.161  301.176  305.192  309.208  313.224  317.239  321.255  325.271  329.286  333.302  337.318  341.333  345.349  349.365  353.38  357.396  361.412  365.427  369.443  373.459  377.475  381.49  385.506  389.522  393.537  397.553  401.569  405.584  409.6  413.616  417.631  421.647  425.663  429.678  433.694  437.71  441.725  445.741  449.757  453.773  457.788  461.804  465.82  469.835  473.851  477.867  481.882  485.898  489.914  493.929  497.945  501.961  505.976  509.992  514.008  518.024  522.039  526.055  530.071  534.086  538.102  542.118  546.133  550.149  554.165  558.18  562.196  566.212  570.227  574.243  578.259  582.275  586.29  590.306  594.322  598.337  602.353  606.369  610.384  614.4  618.416  622.431  626.447  630.463  634.478  638.494  642.51  646.525  650.541  654.557  658.573  662.588  666.604  670.62  674.635  678.651  682.667  686.682  690.698  694.714  698.729  702.745  706.761  710.776  714.792  718.808  722.824  726.839  730.855  734.871  738.886  742.902  746.918  750.933  754.949  758.965  762.98  766.996  771.012  775.027  779.043  783.059  787.075  791.09  795.106  799.122  803.137  807.153  811.169  815.184  819.2  823.216  827.231  831.247  835.263  839.278  843.294  847.31  851.325  855.341  859.357  863.373  867.388  871.404  875.42  879.435  883.451  887.467  891.482  895.498  899.514  903.529  907.545  911.561  915.576  919.592  923.608  927.624  931.639  935.655  939.671  943.686  947.702  951.718  955.733  959.749  963.765  967.78  971.796  975.812  979.827  983.843  987.859  991.875  995.89  999.906  1003.92  1007.94  1011.95  1015.97  1019.98  1024  3048 
ABL.temperature_values = 300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300  300 300 
ABL.u_values = 2.53797  3.48047  3.95599  4.27513  4.51693  4.71293  4.87887  5.02372  5.15308  5.27067  5.37904  5.48006  5.57511  5.66523  5.75123  5.83374  5.91327  5.99023  6.06495  6.13769  6.2087  6.27816  6.34622  6.41303  6.47869  6.54331  6.60696  6.66972  6.73165  6.79281  6.85324  6.91299  6.97208  7.03056  7.08844  7.14575  7.20252  7.25876  7.31449  7.36972  7.42447  7.47875  7.53256  7.58592  7.63884  7.69131  7.74335  7.79496  7.84615  7.89692  7.94727  7.9972  8.04673  8.09584  8.14454  8.19284  8.24073  8.28822  8.3353  8.38197  8.42824  8.4741  8.51955  8.5646  8.60924  8.65348  8.6973  8.74071  8.78371  8.8263  8.86848  8.91024  8.95158  8.9925  9.03301  9.07309  9.11275  9.15199  9.1908  9.22918  9.26713  9.30465  9.34173  9.37838  9.41459  9.45037  9.4857  9.52059  9.55504  9.58904  9.62259  9.65569  9.68834  9.72053  9.75227  9.78355  9.81438  9.84474  9.87463  9.90406  9.93303  9.96153  9.98955  10.0171  10.0442  10.0708  10.0969  10.1226  10.1477  10.1724  10.1966  10.2203  10.2435  10.2662  10.2885  10.3102  10.3315  10.3522  10.3725  10.3922  10.4115  10.4302  10.4485  10.4662  10.4834  10.5002  10.5164  10.5321  10.5473  10.5619  10.5761  10.5897  10.6029  10.6155  10.6276  10.6391  10.6502  10.6607  10.6707  10.6802  10.6892  10.6976  10.7055  10.713  10.7198  10.7262  10.732  10.7374  10.7422  10.7465  10.7503  10.7535  10.7563  10.7586  10.7603  10.7616  10.7623  10.7626  10.7624  10.7617  10.7605  10.7588  10.7566  10.754  10.751  10.7474  10.7435  10.739  10.7342  10.7289  10.7232  10.7171  10.7105  10.7036  10.6963  10.6886  10.6805  10.6721  10.6633  10.6541  10.6446  10.6348  10.6247  10.6142  10.6035  10.5924  10.5811  10.5695  10.5576  10.5454  10.533  10.5204  10.5075  10.4943  10.481  10.4674  10.4537  10.4397  10.4255  10.4112  10.3966  10.3819  10.367  10.3519  10.3367  10.3213  10.3057  10.29  10.2741  10.2581  10.2419  10.2255  10.2089  10.1922  10.1753  10.1581  10.1408  10.1232  10.1053  10.0871  10.0693  10.0527  10.0383  10.0265  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175  10.0175 
ABL.v_values = 1.18452  1.6244  1.8393  1.97923  2.08216  2.1632  2.22985  2.28636  2.33538  2.37862  2.41731  2.45228  2.48418  2.51348  2.54054  2.56566  2.58906  2.61093  2.6314  2.65061  2.66866  2.68562  2.70158  2.71658  2.73069  2.74395  2.75639  2.76805  2.77897  2.78916  2.79865  2.80746  2.81561  2.82312  2.83  2.83627  2.84194  2.84702  2.85153  2.85547  2.85886  2.8617  2.864  2.86577  2.86703  2.86777  2.86801  2.86774  2.86699  2.86575  2.86404  2.86185  2.85919  2.85608  2.85251  2.8485  2.84404  2.83915  2.83383  2.82808  2.82191  2.81533  2.80833  2.80094  2.79314  2.78496  2.77638  2.76743  2.75809  2.74838  2.73831  2.72787  2.71708  2.70593  2.69444  2.6826  2.67043  2.65793  2.6451  2.63195  2.61848  2.6047  2.59062  2.57623  2.56155  2.54658  2.53132  2.51578  2.49996  2.48387  2.46752  2.45091  2.43404  2.41692  2.39956  2.38196  2.36412  2.34605  2.32776  2.30925  2.29053  2.27159  2.25245  2.23312  2.21359  2.19387  2.17397  2.1539  2.13365  2.11323  2.09266  2.07193  2.05104  2.03002  2.00885  1.98755  1.96612  1.94457  1.9229  1.90112  1.87923  1.85725  1.83516  1.81299  1.79074  1.76841  1.74601  1.72354  1.70101  1.67843  1.65581  1.63314  1.61043  1.5877  1.56495  1.54218  1.51939  1.49661  1.47383  1.45105  1.4283  1.40556  1.38285  1.36018  1.33756  1.31498  1.29245  1.26999  1.2476  1.22528  1.20305  1.1809  1.15885  1.1369  1.11506  1.09334  1.07174  1.05026  1.02893  1.00773  0.986672  0.965771  0.945027  0.924446  0.904034  0.883794  0.863732  0.843853  0.824161  0.804659  0.785351  0.766241  0.747332  0.728626  0.710126  0.691834  0.673752  0.655881  0.638222  0.620775  0.603541  0.58652  0.569712  0.553115  0.536729  0.520552  0.504581  0.488816  0.473253  0.457889  0.442722  0.427747  0.412961  0.39836  0.383938  0.369692  0.355617  0.341706  0.327953  0.314354  0.300901  0.287587  0.274405  0.261348  0.248407  0.235574  0.22284  0.210194  0.197628  0.185128  0.172684  0.160282  0.147907  0.135544  0.123174  0.110778  0.098332  0.0858092  0.0731778  0.0604389  0.0479863  0.0364498  0.0264186  0.0182578  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438  0.0120438 
ABL.tke_values = 0.588259  0.581096  0.571932  0.562066  0.552859  0.544297  0.536286  0.528741  0.521589  0.514772  0.508242  0.50196  0.49589  0.490007  0.484287  0.478711  0.473262  0.467926  0.462691  0.457548  0.452488  0.447504  0.442589  0.437738  0.432948  0.428212  0.42353  0.418896  0.41431  0.409768  0.405268  0.40081  0.396391  0.392011  0.387667  0.38336  0.379088  0.37485  0.370647  0.366476  0.362338  0.358232  0.354158  0.350115  0.346103  0.342122  0.338171  0.33425  0.330358  0.326496  0.322663  0.31886  0.315085  0.311339  0.307621  0.303932  0.30027  0.296637  0.293032  0.289454  0.285904  0.282381  0.278886  0.275418  0.271977  0.268562  0.265175  0.261815  0.258481  0.255173  0.251893  0.248638  0.24541  0.242208  0.239032  0.235882  0.232759  0.229661  0.226589  0.223543  0.220522  0.217528  0.214559  0.211615  0.208697  0.205805  0.202938  0.200097  0.197281  0.194491  0.191726  0.188986  0.186272  0.183583  0.18092  0.178282  0.17567  0.173083  0.170521  0.167985  0.165475  0.16299  0.160531  0.158098  0.15569  0.153308  0.150953  0.148623  0.146319  0.144041  0.14179  0.139565  0.137366  0.135194  0.133048  0.130929  0.128837  0.126773  0.124735  0.122724  0.120742  0.118786  0.116858  0.114959  0.113087  0.111244  0.109428  0.107642  0.105884  0.104155  0.102455  0.100785  0.0991438  0.0975324  0.0959507  0.094399  0.0928775  0.0913863  0.0899256  0.0884955  0.0870962  0.0857279  0.0843907  0.0830846  0.0818099  0.0805666  0.0793549  0.0781747  0.0770262  0.0759093  0.0748242  0.0737708  0.072749  0.0717589  0.0708004  0.0698733  0.0689776  0.068113  0.0672795  0.0664767  0.0657044  0.0649624  0.0642504  0.0635679  0.0629146  0.0622901  0.0616939  0.0611256  0.0605845  0.0600703  0.0595822  0.0591197  0.058682  0.0582686  0.0578786  0.0575114  0.0571661  0.056842  0.0565381  0.0562538  0.0559879  0.0557396  0.0555081  0.0552921  0.0550909  0.0549033  0.0547282  0.0545645  0.0544111  0.0542668  0.0541303  0.0540003  0.0538755  0.0537544  0.0536356  0.0535174  0.0533981  0.0532759  0.0531488  0.0530148  0.0528716  0.0527166  0.0525472  0.0523603  0.0521526  0.0519204  0.0516597  0.0513659  0.0510338  0.0506576  0.0502308  0.0497458  0.0491942  0.048566  0.0478501  0.0470332  0.0461  0.0450323  0.0438086  0.0424031  0.0407873  0.0389596  0.0369612  0.0348649  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506  0.0327506 0.0327506 
