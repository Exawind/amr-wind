

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External Driven Terrain Simulations &mdash; AMR-Wind 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Actuator Line Model Calibration" href="calibration.html" />
    <link rel="prev" title="Wall-Modeled RANS" href="rans.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AMR-Wind
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Walkthrough</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="precursor.html">Precursor (ABL) walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbine.html">Turbine simulation walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="terrain.html">LES with Terrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="rans.html">Wall-Modeled RANS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">External Driven Terrain Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Actuator Line Model Calibration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/user.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/theory.html">Theory Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">How to Cite AMR-Wind</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibrefs.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AMR-Wind</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Walkthrough</a></li>
      <li class="breadcrumb-item active">External Driven Terrain Simulations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/walkthrough/noprecursorrans.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="external-driven-terrain-simulations">
<span id="noprecursorrans"></span><h1>External Driven Terrain Simulations<a class="headerlink" href="#external-driven-terrain-simulations" title="Link to this heading">ÔÉÅ</a></h1>
<p>The default method for running inflow-outflow simulation with the immersed forcing terrain method in
AMR-Wind is to run a precursor simulation and use the time-dependent boundary plane from this simulation
to provide the driving conditions. However, this method is not required for RANS simulations and can be
avoided with LES. The schematic of the domain setup is shown below:</p>
<a class="reference internal image-reference" href="../_images/noprecursorSetup.png"><img alt="../_images/noprecursorSetup.png" src="../_images/noprecursorSetup.png" style="width: 100%;" />
</a>
<p>There are several components in the domain setup:</p>
<ol class="arabic simple">
<li><p>Inflow-outflow BC: These boundary conditions are set to <code class="docutils literal notranslate"><span class="pre">pressure_outflow</span></code>. No special handling is required.</p></li>
<li><p>Fringe Zone: The specified profile for velocity, temperature and turbulent kinetic energy is smoothed
through the fringe zone using a weighting function from CFD to specified value.</p></li>
<li><p>Mesoscale Zone: The velocity, temperature and turbulent kinetic energy is smoothed to the externally
specified profile above the approximate height of the boundary layer.</p></li>
<li><p>Surface BC: Allows the ability to specify non-uniform roughness, temperature and heat flux at the terrain
boundaries. The capability is experimental and will be available soon.</p></li>
<li><p>Met-Mast or Lidar: Allows the ability to digest velocity profiles from met-mast and Lidar. The capability
is under development and documentation will be updated once available.</p></li>
</ol>
<p>The first step in the setup is to enable the following flags in the input file:</p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.initial_wind_profile</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">true</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.rans_1dprofile_file</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">&quot;rans_1d.info&quot;</span></code></p>
<p>The profile file specifies the external forcing file. The file contains <cite>z u v tke</cite> (in that order, column format).As the
temperature profile is used with other parts of the code, it is not specified in this file but is added in the input file
as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.temperature_heights</span> <span class="pre">=</span> <span class="pre">0</span>&#160; <span class="pre">8.03137</span>&#160; <span class="pre">16.0627</span>&#160; <span class="pre">24.0941...</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.temperature_values</span> <span class="pre">=</span> <span class="pre">300.001</span>&#160; <span class="pre">300.001</span>&#160; <span class="pre">300.001</span> <span class="pre">...</span></code></p>
<p>This method was initially developed for wall-modeled RANS and has been extended to LES to support ABL profiles from climate
models for non-canonical conditions. Once the profile is available, it can be enabled in the code using the following flags:</p>
<p><code class="docutils literal notranslate"><span class="pre">Temperature.source_terms</span>&#160; <span class="pre">=</span> <span class="pre">TemperatureFreeAtmosphereForcing</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ICNS.source_terms</span>&#160; <span class="pre">=</span> <span class="pre">VelocityFreeAtmosphereForcing</span></code></p>
<p>The above flags enable the Mesoscale zone above the height of the boundary layer specified with the following flag:</p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.meso_sponge_start</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">2560</span></code></p>
<p>The fringe zone can be enabled in any of the four directions (+x, -x, +y and -y) independently. In the external driven approach, they
should be enabled on all the four horizontal boundaries. This is done by adding the following flags:</p>
<p><code class="docutils literal notranslate"><span class="pre">ICNS.source_terms</span> <span class="pre">=</span> <span class="pre">DragForcing</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.horizontal_sponge_temp</span> <span class="pre">=</span> <span class="pre">true</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Temperature.source_terms</span> <span class="pre">=</span> <span class="pre">DragTempForcing</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_west</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_east</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_north</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_south</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<p>The first three flags enables the addition of the forcing term to the momentum and energy equation and the last four terms enable the terms
in fringe zone depicted above. If RANS modeling is used, the following extra flag is required:</p>
<p><code class="docutils literal notranslate"><span class="pre">ABL.horizontal_sponge_tke</span> <span class="pre">=</span> <span class="pre">true</span></code></p>
<p>The size of the fringe zones are set independently in each direction as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_distance_west</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">-2000</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_distance_east</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">3000</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_distance_south</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">-2000</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">DragForcing.sponge_distance_north</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span> <span class="pre">3000</span></code></p>
<p>The negative sign is important at the west and south as the distance is measured from inside to outside. If the sign is missed, the fringe zone size
becomes zero.</p>
<p>Currently, the external profile is static and is read initially when starting simulations. It can be modified in the future to include time-varying
profiles. When this approach is used with LES, no flow structures are generated as the inflow is an one-dimensional profile.
A <a class="reference external" href="https://journals.ametsoc.org/view/journals/mwre/146/6/mwr-d-18-0077.1.xml?tab_body=fulltext-display">cell perturbation forcing method</a> is
introduced for generation of the flow structures and it is enabled as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">Temperature.source_terms</span> <span class="pre">=</span> <span class="pre">PerturbationForcing</span></code></p>
<p>The forcing is specified within a box with an amplitude and a Gaussian distribution with a zero mean and standard deviation equal to the specified
amplitude is added to the energy equation. The inputs can be founded in <a class="reference internal" href="../user/inputs_Temperature_Sources.html#inputs-temperature-sources"><span class="std std-ref">inp</span></a>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rans.html" class="btn btn-neutral float-left" title="Wall-Modeled RANS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="calibration.html" class="btn btn-neutral float-right" title="Actuator Line Model Calibration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>